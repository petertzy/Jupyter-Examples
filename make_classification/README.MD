éå¸¸å¥½ï¼ä½ çš„é—®é¢˜éå¸¸ä¸“ä¸šï¼Œä¹Ÿå¾ˆå®é™…â€”â€”**PyTorch é¡¹ç›®ï¼Œåœ¨ Jupyter å’Œ VS Code åˆ†åˆ«æ€ä¹ˆå†™ï¼Ÿä¸“ä¸šå·¥ç¨‹å¸ˆæ€ä¹ˆé…åˆä¸¤è€…ï¼Ÿ**

ä¸‹é¢ï¼Œæˆ‘ç»™ä½ åšä¸€ä¸ªå®Œæ•´çš„ã€**ä» 0 åˆ° 1 çš„è™šæ‹Ÿé¡¹ç›®æ¼”ç¤º**ã€‚ä½ å°±èƒ½çœ‹åˆ°å®é™…å·®åˆ«ï¼Œä¹Ÿèƒ½ç†è§£ä¸¤ç§å·¥å…·å¦‚ä½•ç»“åˆæœ€æœ‰æ•ˆã€‚

> **æ¡ˆä¾‹åœºæ™¯ï¼š**
>
> * æˆ‘ä»¬ç”¨ PyTorch è®­ç»ƒä¸€ä¸ªç®€å•çš„äºŒåˆ†ç±»ç¥ç»ç½‘ç»œã€‚
> * å‡è®¾è¦åœ¨ä¸€ä¸ª CSV æ–‡ä»¶é‡Œåšåˆ†ç±»ä»»åŠ¡ï¼Œæ¯”å¦‚é¢„æµ‹æŸä¸ªç‰¹å¾æ˜¯å¦å¤§äºé˜ˆå€¼ã€‚
> * æˆ‘ä¼šæ¼”ç¤ºï¼š
>
>   1. åœ¨ Jupyter Notebook é‡Œæ€ä¹ˆåšå®éªŒã€‚
>   2. åœ¨ VS Code é‡Œæ€ä¹ˆæŠŠä»£ç å·¥ç¨‹åŒ–ã€‚

---

# âœ… Part 1 â€” åœ¨ Jupyter Notebook é‡Œå¿«é€Ÿå®éªŒ

ä¸“ä¸šäººå£«å¸¸å¸¸å…ˆåœ¨ Jupyter **æ¢ç´¢æ•°æ® + éªŒè¯æ¨¡å‹å¯è¡Œæ€§**ã€‚ä¸‹é¢æ¼”ç¤ºæµç¨‹ï¼š

---

## (1) å¯¼å…¥åº“

åœ¨ Jupyter é‡Œï¼Œæ–°å»º Notebookï¼Œç¬¬ä¸€æ ¼é€šå¸¸å†™ï¼š

```python
import torch
import torch.nn as nn
import torch.optim as optim
from sklearn.datasets import make_classification
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
```

---

## (2) ç”Ÿæˆæˆ–è½½å…¥æ•°æ®

ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ç”¨ `make_classification` é€ ä¸ªå‡æ•°æ®ï¼š

```python
# ç”Ÿæˆ 2 åˆ†ç±»æ•°æ®
X, y = make_classification(
    n_samples=500,
    n_features=2,
    n_informative=2,
    n_redundant=0,
    n_clusters_per_class=1,
    random_state=42
)

# è½¬æˆ DataFrameï¼ŒåƒçœŸå®æ•°æ®é‚£æ ·
df = pd.DataFrame(X, columns=['feature1', 'feature2'])
df['target'] = y

df.head()
```

è¿è¡Œè¿™æ®µï¼ŒNotebook ä¼šç›´æ¥æ˜¾ç¤ºæ¼‚äº®çš„è¡¨æ ¼ï¼š

| feature1 | feature2 | target |
| -------- | -------- | ------ |
| ...      | ...      | ...    |

---

## (3) å¯è§†åŒ–æ•°æ®

ä¸‹ä¸€æ ¼å†™ï¼š

```python
plt.scatter(df['feature1'], df['feature2'], c=df['target'])
plt.xlabel('feature1')
plt.ylabel('feature2')
plt.title('Classification Data')
plt.show()
```

ç»“æœç›´æ¥åµŒåœ¨ Notebookï¼Œå¾ˆç›´è§‚ã€‚

---

## (4) å‡†å¤‡ PyTorch æ•°æ®é›†

å†å¼€ä¸€ä¸ª Cellï¼š

```python
from torch.utils.data import TensorDataset, DataLoader

X_tensor = torch.tensor(X, dtype=torch.float32)
y_tensor = torch.tensor(y, dtype=torch.long)

dataset = TensorDataset(X_tensor, y_tensor)
loader = DataLoader(dataset, batch_size=32, shuffle=True)
```

---

## (5) å®šä¹‰æ¨¡å‹

å†å†™ï¼š

```python
class SimpleNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(2, 16),
            nn.ReLU(),
            nn.Linear(16, 2)
        )
    
    def forward(self, x):
        return self.net(x)

model = SimpleNet()
```

---

## (6) å®šä¹‰æŸå¤±å’Œä¼˜åŒ–å™¨

```python
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.01)
```

---

## (7) è®­ç»ƒå¾ªç¯

åœ¨ Notebook é‡Œè·‘å‡ è½®ï¼š

```python
losses = []

for epoch in range(20):
    total_loss = 0
    for xb, yb in loader:
        preds = model(xb)
        loss = criterion(preds, yb)
        
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
        
        total_loss += loss.item()
    
    avg_loss = total_loss / len(loader)
    losses.append(avg_loss)
    print(f"Epoch {epoch+1} - Loss: {avg_loss:.4f}")
```

---

## (8) å¯è§†åŒ– Loss

ç›´æ¥ç”»å›¾ï¼š

```python
plt.plot(losses)
plt.title('Training Loss')
plt.show()
```

åœ¨ Jupyterï¼Œç”»å›¾ç‰¹åˆ«æ–¹ä¾¿ï¼Œçœ‹ç»“æœéå¸¸ç›´è§‚ã€‚

---

âœ… **æ­¤æ—¶ï¼š**

* æ¨¡å‹è®­ç»ƒéªŒè¯å®Œæˆã€‚
* ä½ è¯•è¿‡ä¸åŒå±‚æ•°ã€æ¿€æ´»å‡½æ•°ã€å­¦ä¹ ç‡éƒ½å¾ˆæ–¹ä¾¿ã€‚
* ä½†ä»£ç éå¸¸ç¢ç‰‡åŒ–ã€‚

---

# âœ… Part 2 â€” åœ¨ VS Code é‡Œå·¥ç¨‹åŒ–

ç°åœ¨ï¼Œå‡è®¾ä½ åœ¨ Jupyter å®éªŒæˆåŠŸï¼Œæƒ³æŠŠé¡¹ç›®åšæˆèƒ½åå¤ä½¿ç”¨ã€å¯ç»´æŠ¤çš„ä»£ç ã€‚å°±éœ€è¦ VS Codeã€‚

ä¸“ä¸šå·¥ç¨‹å¸ˆé€šå¸¸è¿™ä¹ˆåšï¼š

---

## (1) å»ºå·¥ç¨‹ç›®å½•

æ¯”å¦‚ï¼š

```
myproject/
    data/
    models/
        __init__.py
        model.py
    train.py
    utils.py
    requirements.txt
```

---

## (2) å†™ model.py

`models/model.py`

```python
import torch
import torch.nn as nn

class SimpleNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(2, 16),
            nn.ReLU(),
            nn.Linear(16, 2)
        )
    
    def forward(self, x):
        return self.net(x)
```

---

## (3) å†™ utils.py

`utils.py`

```python
from torch.utils.data import TensorDataset, DataLoader
import torch

def get_dataloader(X, y, batch_size=32):
    X_tensor = torch.tensor(X, dtype=torch.float32)
    y_tensor = torch.tensor(y, dtype=torch.long)
    
    dataset = TensorDataset(X_tensor, y_tensor)
    loader = DataLoader(dataset, batch_size=batch_size, shuffle=True)
    return loader
```

---

## (4) å†™ train.py

`train.py`

```python
import torch
import torch.optim as optim
import torch.nn as nn
import matplotlib.pyplot as plt
import numpy as np
from sklearn.datasets import make_classification
from utils import get_dataloader
from models.model import SimpleNet

# ç”Ÿæˆæ•°æ®
X, y = make_classification(
    n_samples=500,
    n_features=2,
    n_informative=2,
    n_redundant=0,
    n_clusters_per_class=1,
    random_state=42
)

# DataLoader
loader = get_dataloader(X, y)

# æ¨¡å‹
model = SimpleNet()

# æŸå¤±ä¸ä¼˜åŒ–å™¨
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=0.01)

losses = []

# è®­ç»ƒ
for epoch in range(20):
    total_loss = 0
    for xb, yb in loader:
        preds = model(xb)
        loss = criterion(preds, yb)

        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        total_loss += loss.item()
    
    avg_loss = total_loss / len(loader)
    losses.append(avg_loss)
    print(f"Epoch {epoch+1} - Loss: {avg_loss:.4f}")

# å¯è§†åŒ– Loss
plt.plot(losses)
plt.title('Training Loss')
plt.show()
```

---

## (5) ç”¨ VS Code çš„å¥½å¤„

* ä½ å¯ä»¥**æ‰“æ–­ç‚¹**å•æ­¥è°ƒè¯•ã€‚
* è‡ªåŠ¨è¡¥å…¨ã€æ™ºèƒ½æç¤ºã€‚
* ç‰ˆæœ¬æ§åˆ¶éå¸¸æ¸…æ¥šï¼ˆ`.py` æ–‡ä»¶ï¼‰ã€‚
* ä»£ç æ›´æ˜“ç»´æŠ¤ã€æ¨¡å—åŒ–ã€‚
* æ›´é€‚åˆåˆä½œå¼€å‘ã€‚

---

# âœ… ä¸“ä¸šå·¥ç¨‹å¸ˆçš„å®é™…åšæ³•

**æœ€å¸¸ç”¨çš„ workflowï¼š**

âœ… **å…ˆç”¨ Jupyter:**

* å¿«é€Ÿè¯•éªŒæƒ³æ³•
* è°ƒå‚æ•°
* çœ‹æ¨¡å‹æ˜¯å¦ work

âœ… **å†ç”¨ VS Code:**

* å°†è¯•éªŒæˆåŠŸçš„ä»£ç æç‚¼æˆæ¨¡å—
* å†™æˆæ¸…æ™°è„šæœ¬
* åšç‰ˆæœ¬ç®¡ç†

ä¸¤è€…ç»“åˆæ•ˆç‡æœ€é«˜ã€‚

---

## ğŸ¯ æœ€ç»ˆå»ºè®®

* å¦‚æœä½ æ˜¯**åˆå­¦**æˆ–è€…æ­£åœ¨å¿«é€Ÿè¯•éªŒ â†’ ä» Jupyter å¼€å§‹ã€‚
* å¦‚æœè¦å†™å¯é‡å¤ã€å¯åˆ†äº«ã€å¯éƒ¨ç½²çš„ä»£ç  â†’ æ”¾åˆ° VS Codeã€‚

---

è¦ä¸è¦æˆ‘æŠŠè¿™æ•´ä¸ªä¾‹å­åšæˆå®Œæ•´çš„ä»£ç åŒ…ç»™ä½ ï¼Ÿæˆ–è€…ï¼Œä½ æƒ³æ¢ä¸ªåœºæ™¯ï¼ˆæ¯”å¦‚å›¾ç‰‡åˆ†ç±»ã€NLPï¼‰æ¼”ç¤ºå—ï¼Ÿ

---

å¥½é—®é¢˜ï¼æˆ‘æ¥æ‰‹æŠŠæ‰‹æ•™ä½ åœ¨ **VS Code ä¸­è¿è¡Œä¸Šé¢é‚£å¥— PyTorch å·¥ç¨‹ä»£ç **ã€‚

æˆ‘ä»¬å‡è®¾ä½ å·²ç»æŠŠ `VS Code` å®‰è£…å¥½äº†ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼Œæˆ‘ä¹Ÿå¯ä»¥æ•™ä½ å®‰è£…ï¼‰ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´æ“ä½œæµç¨‹ï¼š

---

# ğŸ§± é¡¹ç›®ç»“æ„å›é¡¾

ä½ åˆ›å»ºçš„é¡¹ç›®ç›®å½•åº”è¯¥é•¿è¿™æ ·ï¼š

```
myproject/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ model.py
â”œâ”€â”€ utils.py
â”œâ”€â”€ train.py
```

---

# âœ… ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡ç¯å¢ƒ

## 1. æ‰“å¼€ VS Codeï¼Œæ‰“å¼€é¡¹ç›®ç›®å½•

* å¯åŠ¨ VS Code
* ç‚¹å‡»å·¦è¾¹æ  "Explorer"
* é€‰æ‹© **File â†’ Open Folder...**ï¼Œé€‰ä¸­ä½ çš„ `myproject/` æ–‡ä»¶å¤¹

ä½ åº”è¯¥èƒ½çœ‹åˆ°å·¦ä¾§æ å·²ç»åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶ã€‚

---

## 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆæ¨èï¼‰

ä¸ºäº†éš”ç¦»ä¾èµ–ï¼Œå»ºè®®åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼š

æ‰“å¼€ç»ˆç«¯ï¼ˆVS Code å†…ç½®ç»ˆç«¯å¿«æ·é”®æ˜¯ `Ctrl + `ï¼ˆé”®ç›˜å·¦ä¸Šè§’ï¼‰ï¼‰ï¼š

```bash
python -m venv venv
```

ç„¶åæ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š

* Windowsï¼š

  ```bash
  .\venv\Scripts\activate
  ```
* macOS/Linuxï¼š

  ```bash
  source venv/bin/activate
  ```

---

## 3. å®‰è£…ä¾èµ–åº“

è™šæ‹Ÿç¯å¢ƒæ¿€æ´»åï¼Œå®‰è£… PyTorch å’Œå…¶å®ƒåº“ï¼š

```bash
pip install torch scikit-learn matplotlib
```

ä½ å¯ä»¥é¡ºä¾¿æŠŠè¿™äº›ä¾èµ–å†™è¿› `requirements.txt` é‡Œï¼š

```text
torch
scikit-learn
matplotlib
```

ä»¥åå¯ä»¥ä¸€è¡Œå‘½ä»¤å®‰è£…ï¼š

```bash
pip install -r requirements.txt
```

---

# âœ… ç¬¬äºŒæ­¥ï¼šè¿è¡Œ `train.py`

ä½ å¯ä»¥é€‰æ‹©ä¸‰ç§æ–¹å¼è¿è¡Œï¼š

---

## æ–¹æ³• 1ï¼šä½¿ç”¨å†…ç½®ç»ˆç«¯è¿è¡Œ

åœ¨ VS Code ç»ˆç«¯è¾“å…¥ï¼š

```bash
python train.py
```

ä½ å°±ä¼šçœ‹åˆ°ï¼š

```
Epoch 1 - Loss: ...
Epoch 2 - Loss: ...
...
```

æœ€åä¼šå¼¹å‡ºä¸€å¼  Loss æ›²çº¿å›¾ï¼ˆmatplotlibï¼‰ã€‚

---

## æ–¹æ³• 2ï¼šåœ¨ä»£ç ä¸­è®¾ç½®æ–­ç‚¹è°ƒè¯•ï¼ˆæ¨èï¼‰

* æ‰“å¼€ `train.py`
* ç‚¹å‡»è¡Œå·å·¦è¾¹æ·»åŠ æ–­ç‚¹ï¼ˆçº¢ç‚¹ï¼‰
* æŒ‰ F5 æˆ–ç‚¹å‡»å·¦ä¾§ "Run and Debug"ï¼ˆè¿è¡Œä¸è°ƒè¯•ï¼‰
* VS Code ä¼šæç¤ºä½ é€‰æ‹©è§£é‡Šå™¨ï¼ˆé€‰ä½ åˆšå»ºçš„ venvï¼‰
* è‡ªåŠ¨å¯åŠ¨è°ƒè¯•å™¨ï¼Œå¯ä»¥å•æ­¥è¿è¡Œã€æŸ¥çœ‹å˜é‡ç­‰

---

## æ–¹æ³• 3ï¼šä½¿ç”¨å³é”®è¿è¡Œä»£ç ï¼ˆéœ€å®‰è£…æ‰©å±•ï¼‰

ä½ å¯ä»¥å®‰è£… VS Code æ’ä»¶ï¼š

* Python æ’ä»¶ï¼ˆMicrosoft å®˜æ–¹ï¼‰
* Jupyter æ’ä»¶ï¼ˆå¯è¿è¡Œ `.ipynb`ï¼‰
* Code Runner æ’ä»¶ï¼ˆå¯ä»¥å³é”®è¿è¡Œä»»æ„ Python æ–‡ä»¶ï¼‰

å®‰è£…åå°±å¯ä»¥ï¼š

* åœ¨ `train.py` ç©ºç™½å¤„ **å³é”® â†’ Run Python File**
* æˆ–åœ¨é¡¶éƒ¨èœå•ç‚¹ â–¶ï¸ å›¾æ ‡è¿è¡Œ

---

# âœ… ä»£ç è¿è¡Œå®Œåç»“æœ

ä½ åº”è¯¥èƒ½çœ‹åˆ°ï¼š

* æ§åˆ¶å°è¾“å‡ºæ¯ä¸ª epoch çš„ loss
* å¼¹å‡º matplotlib çš„è®­ç»ƒ loss æ›²çº¿å›¾

---

# ğŸ“¦ Bonusï¼šå°† notebook ä»£ç å¯¼å‡ºä¸º `.py`

å¦‚æœä½ ä¸€å¼€å§‹æ˜¯åœ¨ Jupyter Notebook å¼€å‘çš„ï¼Œå¯ä»¥ï¼š

* File â†’ Download as â†’ Python (.py)
* æŠŠå®ƒç²˜è´´è¿› VS Codeï¼Œç„¶åå·¥ç¨‹åŒ–æ•´ç†ã€‚

---

# â“å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜                          | è§£å†³æ–¹æ¡ˆ                                           |
| --------------------------- | ---------------------------------------------- |
| æ¨¡å—æ‰¾ä¸åˆ° `ModuleNotFoundError` | ç¡®è®¤ä½ æ¿€æ´»äº†è™šæ‹Ÿç¯å¢ƒ & å®‰è£…äº†ä¾èµ–                             |
| å›¾è¡¨å¼¹ä¸å‡ºæ¥                      | æœ‰æ—¶éœ€åœ¨ä»£ç æœ«å°¾åŠ  `plt.show()`                         |
| VS Code æ²¡è¯†åˆ«è™šæ‹Ÿç¯å¢ƒ             | `Ctrl+Shift+P` â†’ é€‰æ‹©è§£é‡Šå™¨ â†’ é€‰ `./venv/bin/python` |

---

# âœ… æ€»ç»“æ­¥éª¤ç®€è¡¨

| æ­¥éª¤     | æ“ä½œ                                          |
| ------ | ------------------------------------------- |
| å»ºç›®å½•    | `mkdir myproject && cd myproject`           |
| å†™æ–‡ä»¶    | å†™å¥½ `train.py`ã€`utils.py`ã€`models/model.py`  |
| åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ | `python -m venv venv` + æ¿€æ´»                  |
| å®‰è£…åº“    | `pip install torch matplotlib scikit-learn` |
| è¿è¡Œ     | `python train.py` or F5 å¯åŠ¨è°ƒè¯•                |
| å·¥ç¨‹åŒ–    | æ¨¡å—åˆ’åˆ†ã€ç‰ˆæœ¬ç®¡ç†ã€è°ƒè¯•                                |

---

å¦‚æœä½ æƒ³ï¼Œæˆ‘å¯ä»¥ï¼š

* ç»™ä½ æ‰“ä¸€ä¸ªå®Œæ•´çš„ä»£ç å‹ç¼©åŒ…
* æˆ–è€…æ‰‹æŠŠæ‰‹å¸®ä½ é…ç½® VS Code çš„è°ƒè¯•é…ç½® (`.vscode/launch.json`)
* æˆ–è€…å¸¦ä½ æŠŠ Jupyter é‡Œçš„ä»£ç ä¸€æ­¥æ­¥è¿ç§»è¿‡æ¥

éœ€è¦å“ªç§å¸®åŠ©ä½ è¯´ä¸€å£°ï¼ğŸŒŸ
